#!/bin/sh

#  Credit To https://www.shawonruet.com/2016/03/english-to-bangla-date-converter-c.html
# According to Bangla Academy 2019 revision Boishakh-Aashwin will be 31days, Kartik-Choitra ( except Falgun ) will be 30days, Falgun will be 29days(30days in the leap year)
# Bangla date count starts with the rising of the sun. So date is corrected to change at 6 in morning with GMT. If date doesn't change accordingly uncomment line 17  and comment 18.


while getopts ":d:m:y:f:h" o; do case "${o}" in
	h) printf "Optional arguments for custom use:\\n  -d: Date\\n  -m: Month\\n  -y: Year\\n -f: Date Format\\n -h: Show this help message\\n" && exit 1 ;;
	d) en_dt=${OPTARG} ;;
	m) en_m=${OPTARG} ;;
	y) en_y=${OPTARG} ;;
	f) dt_f=${OPTARG} ;;
	*) printf "Invalid option: -%s\\n" "$OPTARG" && exit 1 ;;
esac done

# [ -z $en_dt ] && en_dt=$(date +%d)
[ -z $en_dt ] && en_dt=$(TZ='Europe/London' date +"%d")
[ -z $en_m ] && en_m=$(date +%m | sed 's/^0//g' )
[ -z $en_y ] && en_y=$(date +%Y)
[ -z $dt_f ] && dt_f="0"

lp_y=$(( $en_y % 4 ))
en_d=$(date --date=$en_y-$en_m-$en_dt +%u)
# en_d=$(date +%u)

# text in bangla or bangreji/english
# comment uncomment bday bmo bsn din and every line of bdate function for bangreji/english.

declare -A bday
bday=( [1]='সোম' [2]='মঙ্গল' [3]='বুধ' [4]='বৃহঃ' [5]='শুক্র' [6]='শনি' [7]='রবি' )
# bday=( [1]='Som' [2]='Mongol' [3]='Budh' [4]='Briho' [5]='Shukro' [6]='Shoni' [7]='Robi' )

declare -A bdate
bdate=( 
[1]='১' [2]='২' [3]='৩' [4]='৪' [5]='৫' [6]='৬' [7]='৭' [8]='৮' [9]='৯' [10]='১০'
[11]='১১' [12]='১২' [13]='১৩' [14]='১৪' [15]='১৫' [16]='১৬' [17]='১৭' [18]='১৮' [19]='১৯' [20]='২০'
[21]='২১' [22]='২২' [23]='২৩' [24]='২৪' [25]='২৫' [26]='২৬' [27]='২৭' [28]='২৮' [29]='২৯' [30]='৩০' [31]='৩১'
)

declare -A bmo
bmo=( [1]='বৈশাখ' [2]='জৈষ্ঠ্য' [3]='আষাঢ়' [4]='শ্রাবণ' [5]='ভাদ্র' [6]='আশ্বিন' [7]='কার্তিক' [8]='অগ্রাহায়ণ' [9]='পৌষ' [10]='মাঘ' [11]='ফাল্গুন' [12]='চৈত্র' )
# bmo=( [1]='Boishakh' [2]='Jaistha' [3]='Aashar' [4]='Srabon' [5]='Vhadra' [6]='Aashwin' [7]='Kartik' [8]='Agrahayon' [9]='Poush' [10]='Magh' [11]='Falgun' [12]='Chaitra' )

declare -A bsn
bsn=( [1]='গ্রীষ্ম' [2]='বর্ষা' [3]='শরৎ' [4]='হেমন্ত' [5]='শীত' [6]='বসন্ত' )
# bsn=( [1]='Grishsho' [2]='Borsha' [3]='Sharot' [4]='Hemanta' [5]='Sheet' [6]='Basanta' )


bongabdo() {
    if [ $en_m -eq 4 ]; then
        if [ $en_dt -le 13 ]; then
        bn_y=$(( $en_y - 594 ))
    else 
        bn_y=$(( $en_y - 593 ))
        fi

    elif [ $en_m -lt 4 ]; then
        bn_y=$(( $en_y - 594 ))
    elif [ $en_m -gt 4 ]; then
        bn_y=$(( $en_y - 593 ))
    fi
    printf "%s" "$bn_y"
}

tariq() {
    if [ $en_m -eq 4 ]; then
        if [ $en_dt -lt 14 ]; then
            bn_m=12
            bn_s=6
            bn_dt=$(( $en_dt + 14 + 3 ))
        elif [ $en_dt -ge 14 ]; then
            bn_m=1
            bn_s=1
            bn_dt=$(( $en_dt - 14 + 1 ))
        fi
    fi

    if [ $en_m -eq 5 ]; then
        if [ $en_dt -lt 15 ]; then
            bn_m=1
            bn_s=1
            bn_dt=$(( $en_dt + 15 + 2 ))
        elif [ $en_dt -ge 15 ]; then
            bn_m=2
            bn_s=1
            bn_dt=$(( $en_dt - 15 + 1 ))
        fi
    fi

    if [ $en_m -eq 6 ]; then
        if [ $en_dt -lt 15 ]; then
            bn_m=2
            bn_s=1
            bn_dt=$(( $en_dt + 15 + 2 ))
        elif [ $en_dt -ge 15 ]; then
            bn_m=3
            bn_s=2
            bn_dt=$(( $en_dt - 15 + 1 ))
        fi
    fi

    if [ $en_m -eq 7 ]; then
        if [ $en_dt -lt 16 ]; then
            bn_m=3
            bn_s=2
            bn_dt=$(( $en_dt + 16 ))
        elif [ $en_dt -ge 16 ]; then
            bn_m=4
            bn_s=2
            bn_dt=$(( $en_dt - 16 + 1 ))
        fi
    fi

    if [ $en_m -eq 8 ]; then
        if [ $en_dt -lt 16 ]; then
            bn_m=4
            bn_s=2
            bn_dt=$(( $en_dt + 16 ))
        elif [ $en_dt -ge 16 ]; then
            bn_m=5
            bn_s=3
            bn_dt=$(( $en_dt - 16 + 1 ))
        fi
    fi

    if [ $en_m -eq 9 ]; then
        if [ $en_dt -lt 16 ]; then
            bn_m=5
            bn_s=3
            bn_dt=$(( $en_dt + 16 ))
        elif [ $en_dt -ge 16 ]; then
            bn_m=6
            bn_s=3
            bn_dt=$(( $en_dt - 16 + 1 ))
        fi
    fi

    if [ $en_m -eq 10 ]; then
        if [ $en_dt -lt 17 ]; then
            bn_m=6
            bn_s=3
            bn_dt=$(( $en_dt + 15 ))
        elif [ $en_dt -ge 17 ]; then
            bn_m=7
            bn_s=4
            bn_dt=$(( $en_dt - 17 + 1 ))
        fi
    fi

    if [ $en_m -eq 11 ]; then
        if [ $en_dt -lt 16 ]; then
            bn_m=7
            bn_s=4
            bn_dt=$(( $en_dt + 14 + 1 ))
        elif [ $en_dt -ge 16 ]; then
            bn_m=8
            bn_s=4
            bn_dt=$(( $en_dt - 16 + 1 ))
        fi
    fi

    if [ $en_m -eq 12 ]; then
        if [ $en_dt -lt 16 ]; then
            bn_m=8
            bn_s=4
            bn_dt=$(( $en_dt + 14 + 1 ))
        elif [ $en_dt -ge 15 ]; then
            bn_m=9
            bn_s=5
            bn_dt=$(( $en_dt - 16 + 1 ))
        fi
    fi

    if [ $en_m -eq 1 ]; then
        if [ $en_dt -lt 15 ]; then
            bn_m=9
            bn_s=5
            bn_dt=$(( $en_dt + 13 + 3 ))
        elif [ $en_dt -ge 15 ]; then
            bn_m=10
            bn_s=5
            bn_dt=$(( $en_dt - 15 + 1 ))
        fi
    fi

    if [ $en_m -eq 2 ]; then
        if [ $en_dt -lt 14 ]; then
            bn_m=10
            bn_s=5
            bn_dt=$(( $en_dt + 12 + 5 ))
        elif [ $en_dt -ge 14 ]; then
            bn_m=11
            bn_s=6
            bn_dt=$(( $en_dt - 14 + 1 ))
        fi
    fi

    if [ $en_m -eq 3 ]; then
        if [ $en_dt -lt 15 ]; then
            if [ $lp_y -ne 0 ]; then
                bn_m=11
                bn_s=6
                bn_dt=$(( $en_dt + 15 ))
            else
                bn_m=11
                bn_s=6
                bn_dt=$(( $en_dt + 15 + 1 ))
            fi
        elif [ $en_dt -ge 15 ]; then
            bn_m=12
            bn_s=6
            bn_dt=$(( $en_dt - 15 + 1 ))
        fi
    fi

        bar=${bday[$en_d]}
		din=${bdate[$bn_dt]}
		# din=$bn_dt
		mas=${bmo[$bn_m]}
        hritu=${bsn[$bn_s]}

    if [ $dt_f -eq 1 ]; then
         printf "%s %s %s" $bar,$din $mas
    elif [ $dt_f -eq 2 ]; then
        printf "%s %s %s %s" $bar,$din $mas "$(bongabdo)"
    elif [ $dt_f -eq 3 ]; then
        printf "%s %s %s" $hritu $din $mas
    elif [ $dt_f -eq 4 ]; then
        printf "%s %s %s %s" $hritu $din $mas "$(bongabdo)"
    else
        printf "%s %s %s %s %s" $hritu $bar $din $mas "$(bongabdo)"
    fi

}

printf "%s" "$(tariq)"
